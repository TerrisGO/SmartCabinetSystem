
<!DOCTYPE html>
<html lang="en">
<head>
<script>
function populateNewTaskCount() {
    // THE JSON ARRAY.

  fetch('http://localhost:5000/count_total_newtask')
  .then(res => res.json())
  .then((out) => {
      console.log('Output: ', out);
      if (typeof out !=='undefined'){
        $("#counttask").text(out);
        if (out == '0'){
          alert("Currently no new task...");
        }
      }else{
        $("#counttask").text('0');
        alert("Currently no new task...");
      }
  }).catch(err => console.error(err));
}
</script>
<style>
/*header*/
#titlelogin {
  left: -82px;
  position: relative;
  top: 40px;
}
#logo {
  width: 191px;
  height: 104px;
}
body { 
  margin: 0;
  font-family: Arial, Helvetica, sans-serif;
}

.header {
  overflow: hidden;
  background-color: #f1f1f1;
  padding: 3px 10px;
  z-index: 10;
}

.header a {
  float: left;
  color: black;
  text-align: center;
  padding: 12px;
  text-decoration: none;
  font-size: 18px; 
  line-height: 25px;
  border-radius: 4px;
}

.header a.logo {
  font-size: 25px;
  font-weight: bold;
}

.header a:hover {
  background-color: #ddd;
  color: black;
}

.header a.active {
  background-color: dodgerblue;
  color: white;
}

.header-right {
  float: right;
}
/*End header Css*/
.card-img-top > img {
  width: 188px;
  height: 188px;
  position: relative;
  bottom: 29px;
  right: 48px;
}
div#qrcode2 {
    margin: 0px;
    padding: 50px;
}
div#qrcode {
    margin: 0px;
    padding: 50px;
}

* {
  box-sizing: border-box;
}

body {
  font-family: Arial, Helvetica, sans-serif;
}

/* Float four columns side by side */
.column {
  float: left;
  width: 25%;
  padding: 0 10px;
}

/* Remove extra left and right margins, due to padding */
.row {margin: 0 -5px;}

/* Clear floats after the columns */
.row:after {
  content: "";
  display: table;
  clear: both;
}

/* Responsive columns */
@media screen and (max-width: 600px) {
  .column {
    width: 100%;
    display: block;
    margin-bottom: 20px;
  }
  .card-img-top > img {
    width: 168px;
    height: 168px;
    position: relative;
    bottom: 30px;
    right: 51px;
  }
  .header {
    padding: 3px 10px;
  }
  .header a {
    float: none;
    display: block;
    text-align: left;
  }
  .header-right {
    float: none;
  }
  #logo {
    width: 136px;
    height: 76px;
    margin: auto;
    position: relative;
    left: 120px;
  }
  #titlelogin {
    left: 6px;
    position: relative;
    top: 18px;
    font-size: 15px;
  }
  .h2, h2 {
    font-size: 25px !important;
  }
  div#qrcode {
    margin: 0px;
    padding: 50px;
    position: relative;
    left: 28px;
  }
  div#qrcode2 {
    margin: 0px;
    padding: 50px;
    position: relative;
    left: 28px;
  }
}

/* Style the counter cards */
.card {
  box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
  padding: 16px;
  text-align: center;
  background-color: #f1f1f1;
  bottom: 80px;
  /*z-index: -1;*/
}
.innercard{
  position: relative;
  top: 0px;
}
/*ALERT DIALOG*/
#confirm {
  display: none;
  background-color: #F3F5F6;
  color: #000000;
  border: 1px solid #aaa;
  position: fixed;
  width: 374px;
  height: 143px;
  left: 37%;
  top: 40%;
  box-sizing: border-box;
  text-align: center;
  border-radius: 25px;
}
#confirm button {
  background-color: #FFFFFF;
  display: inline-block;
  border-radius: 12px;
  border: 4px solid #aaa;
  padding: 5px;
  text-align: center;
  width: 60px;
  height: 35px;
  cursor: pointer;
  position: relative;
  top: 24px;
}
#confirm .message {
  text-align: center;
  font-size: 23px;
  display: inline-block;
  font-family: Arial, Helvetica, sans-serif;
}
</style>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Smart Cabinet Malaysia Staff Portal</title>
    <script type="text/javascript" src="/public/jquery.min.js"></script>
    <script type="text/javascript" src="/public/qrcode.js"></script>
    <!-- BOOTSTRAP CDN -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
</head>
<body>
    <div class="header">
        <a href="#" class="logo"><img style="display: inline;" src="scmlogo.png" alt="logo" id="logo"/></a>
        <h3 id="titlelogin" class="text-center mb-5 text-uppercase text-muted">Smart Cabinet Malaysia Staff Portal</h3>
    </div>
    <div class="container p-5">
        <div class="card">
            <div class="card-body">
                     <h2>Welcome,  <%= name %></h2>
<p>staff infos</p>

<div class="row">
  <!--div class="column">
    <div class="card">
      <img class="card-img-top" src="https://cdn2.iconfinder.com/data/icons/check-code/100/7-512.png"  width="200" height="200"  alt="Card image cap">
      <div class="card-body">
        <h5 class="card-title">A Box number</h5>
        <p class="card-text">Address Some quick example text to build </p>
      </div>
    </div>
  </div-->

  <div class="column">
    <div class="card innercard">
      <h5 class="card-title">A Box ðŸ”‘ number</h5>
      <h5><% if (transfer_status =='Pending') {%> <%=boxID1%> <%}else{%>'None'<%}%></h5>
      <!--img class="card-img-top" src="https://cdn2.iconfinder.com/data/icons/check-code/100/7-512.png"  width="200" height="200"  alt="Card image cap"-->
      <div  class="card-img-top"  id="qrcode" style="width:200px; height:200px;" src="https://cdn2.iconfinder.com/data/icons/check-code/100/7-512.png"></div>
      <div class="card-body">
        <p class="card-text">â›¯ Address</p>
        <p class="card-text"><% if (transfer_status =='Pending') {%> <%=bAddr1%> <%}else{%>'None'<%}%></p>
      </div>
    </div>
  </div>

  <div class="column">
    <div class="card innercard">
      <h5 class="card-title">B Box ðŸ”‘ number</h5>
      <h5><% if (transfer_status =='Pending') {%> <%=boxID2%> <%}else{%>'None'<%}%></h5>
      <!--img class="card-img-top" src="https://cdn2.iconfinder.com/data/icons/check-code/100/7-512.png"  width="200" height="200"  alt="Card image cap"-->
      <!--input class="card-img-top" id="text2" type="text" value="http://jindo.dev.naver.com/collie" width="200" height="200"  /><br /-->
      <div  class="card-img-top"  id="qrcode2" style="width:200px; height:200px; "></div>
      <div class="card-body">
        <p class="card-text">â›¯ Address </p>
        <p class="card-text"><% if (transfer_status =='Pending') {%> <%=bAddr2%> <%}else{%>'None'<%}%></p>
      </div>
    </div>
  </div>
    <div class="card-body">
    <% if (transfer_status !=='Pending') {%>
      <h5 class="card-title">Total available task: </h5><h5 onload="javascript:populateNewTaskCount()" id="counttask"></h5>
    <% } %>
    <h5 class="card-title">Transfer status: </h5>
    <h4 class="card-title" id="transfer_status" value="<%= transfer_status %>"><%= transfer_status %></h4>
    <h5 class="card-title">Transfer ID: </h5>
    <h4 class="card-title"><%= transfer_id %> </h4>
      <% if (transfer_status =='Pending' || transfer_status =='None') { %>
        <h1> ðŸŽ« </h1>
      <% } else { %>
        <a href="/gathertask" class="card-link btn btn-success">Gather new task</a>
      <% } %>
      <br><br>
      <!--a href="#" onclick="location.href='/cancel'" ></a-->
      <% if (transfer_status =='Pending') {  %>
      <form action = "/canceltask" method = "POST" novalidate> 
        <button id="button1" type="submit" onlick="" class="card-link btn btn-warning">Cancel current task</button>
      </form>
      <% }%>
      
    </div>
</div>
                    <a href="/logout" style="z-index: 10" class="btn btn-danger float-right">Logout</a>
            </div>
        </div>
    </div>
    <% if (transfer_status =='Pending') {         
    let qrbox1_ = (qrbox1 !== undefined) ? qrbox1 : "None";
    let qrbox2_ = (qrbox2 !== undefined) ? qrbox2 : "None";%>
    <input id="text" type="hidden" value="<%=qrbox1_%>" style="width:80%" /><br />    
    <input id="text2" type="hidden" value="<%=qrbox2_%>" style="width:80%" /><br />
    <% }else{%>
      <input id="text" type="hidden" value="None" style="width:80%" /><br />    
      <input id="text2" type="hidden" value="None" style="width:80%" /><br />
    <% }%>
<script type="text/javascript" src="/public/homeqr.js"></script>
<script>
function myFunction() {
    var txt;
    var r = confirm("Press a button!\nEither OK or Cancel.\nThe button you pressed will be displayed in the result window.");
    if (r == true) {
    txt = "You pressed OK!";
    } else {
    txt = "You pressed Cancel!";
    }
    document.getElementById("demo").innerHTML = txt;
}

</script>
<% if (transfer_status !=='Pending') {  %>
  <script>populateNewTaskCount();</script>
<% }%>
</body>
</html>